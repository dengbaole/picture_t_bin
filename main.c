#include <stdio.h>
#include "tft_image.h"



unsigned char data0[] = {
    0x00,0x00, 0x00,0x00, 0xFF,0xFF, 0x00,0x00, 0x00,0x00,
    0x00,0x00, 0xFF,0xFF, 0x00,0x00, 0xFF,0xFF, 0x00,0x00,
    0xFF,0xFF, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0xFF,0xFF,
    0xFF,0xFF, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0xFF,0xFF,
    0xFF,0xFF, 0xFF,0xFF, 0xFF,0xFF, 0xFF,0xFF, 0xFF,0xFF,
    0xFF,0xFF, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0xFF,0xFF,
    0xFF,0xFF, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0xFF,0xFF,
};
unsigned char data[] = {
    0x00,0x00, 0x80,0xEC, 0xD9,0xD5, 0xF1,0xF7, 0xF1,0xF8, 0xF1,0xF7, 0xD9,0xB5, 0x81,0x0C, 0x00,0x00,
    0x79,0x0D, 0xD9,0xF8, 0xD9,0xF8, 0xE2,0x18, 0xE1,0xF8, 0xE2,0x18, 0xE2,0x18, 0xE2,0x18, 0x79,0x0D,
    0xB9,0xF6, 0xCA,0x19, 0x38,0x87, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x38,0xA7, 0xCA,0x19, 0xB9,0xF7,
    0xB2,0x3A, 0xBA,0x3A, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0xBA,0x3A, 0xBA,0x3A,
    0xAA,0x3A, 0xA2,0x3A, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0xA2,0x3A, 0xA2,0x3A,
    0x92,0x5B, 0x92,0x5B, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x92,0x5B, 0x92,0x5B,
    0x7A,0x5C, 0x7A,0x5C, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7A,0x7C, 0x82,0x5C,
    0x6A,0x7C, 0x6A,0x7C, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x6A,0x7C, 0x6A,0x7C,
    0x5A,0x9D, 0x5A,0x7D, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x52,0x9D, 0x5A,0x9D,
    0x3A,0x5B, 0x42,0x9E, 0x10,0xC9, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x10,0xC9, 0x42,0x9E, 0x3A,0x5B,
    0x19,0x70, 0x32,0xBE, 0x2A,0xBF, 0x2A,0xBE, 0x2A,0xBE, 0x32,0xBE, 0x2A,0xBE, 0x2A,0xBE, 0x19,0x70,
    0x00,0x00, 0x09,0x70, 0x1A,0x7C, 0x1A,0xBF, 0x1A,0xDF, 0x1A,0xBF, 0x1A,0x9C, 0x09,0x70, 0x00,0x00
};

uint32_t flash_address = 0x00000;
FILE *file = NULL;

void flash_write_bitmap_array_impl(const char* name, const void* array[], uint8_t count) {
    FILE *file = fopen("image_data.bin", "wb");
    if (!file) {
        perror("fopen error");
        //return 1;
    }
	printf("FLASH_sBITMAP flash_%s[%d] = {\n", name, count);
	for (uint8_t i = 0; i < count; i++) {
		const sBITMAP* bmp = array[i];
		if (!bmp) continue;

		const uint32_t data_size = (uint32_t)(bmp->h) * bmp->w * 2;
		const uint32_t current_addr = flash_address;

		// W25Q128_WriteData(bmp->map, current_addr, data_size);
        fwrite(bmp->map, 1, data_size, file);
		flash_address += data_size;

		printf("%d, %d, 0x%x,\n",bmp->w, bmp->h, current_addr);
	}
	printf("};\n");
}


#define flash_write_bitmap_array(array) \
	flash_write_bitmap_array_impl(#array, array, sizeof(array)/sizeof(array[0]))

int main() {
    FILE *file = fopen("image_data.bin", "wb");
    if (!file) {
        perror("fopen error");
        return 1;
    }

    // const size_t data_size = sizeof(data);
    // const size_t written = fwrite(data, 1, data_size, file);
    
    // if (written != data_size) {
    //     perror("fwrite error1");
    //     fclose(file);
    //     return 1;
    // }
    // const size_t data1_size = sizeof(turbo_9_12_9_bmp.map);
    // const size_t written2 = fwrite(turbo_9_12_9_bmp.map, 1, data1_size, file);
    // if (written2 != data_size) {
    //     perror("fwrite error2");
    //     fclose(file);
    //     return 1;
    // }
    // const size_t data1_size = charge_00_bmp.w * charge_00_bmp.h * 2;;
    // const size_t written2 = fwrite(charge_00_bmp.map, 1, data1_size, file);
    // if (written2 != data1_size) {
    //     fprintf(stderr, "fwrite error2: wrote %zu bytes, expected %zu bytes\n", written2, data1_size);
    //     fclose(file);
    //     return 1;
    // }

    // const size_t data2_size = sizeof(charge_array[0].map);
    flash_write_bitmap_array(charge_array);
     flash_write_bitmap_array(charge_array);

    fclose(file);
    printf("File write success!!\n");
    return 0;
}





